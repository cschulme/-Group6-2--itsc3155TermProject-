<!-- Declare variables -->
<% activeMonth = @dateInUse.month %>
<% activeYear = @dateInUse.year %>
<% firstDate = Date.parse('1-'+activeMonth.to_s+'-'+activeYear.to_s) %>
<% numOfDaysInMonth = Time.days_in_month(activeMonth, activeYear) %>
<% case firstDate.cwday %>
<% when 1..6 %>
<%     startingPos = firstDate.cwday + 1 %>
<% else %>
<%     startingPos = 1 %>
<% end %>
<% dayNum = 1 %>

<table class="calendarLayout">
    <tr>
        <th>S</th>
        <th>M</th>
        <th>T</th>
        <th>W</th>
        <th>T</th>
        <th>F</th>
        <th>S</th>
    </tr>
    <tr>
        <% for i in 1..7 %>
            <% if i < startingPos %>
                <td class="inactive"></td>
            <% else %>
                <% dayHolder = Date.parse(dayNum.to_s+'-'+activeMonth.to_s+'-'+activeYear.to_s) %>
                <td>
                    <%= dayNum %>
                    <div class="dayInfo">
                        <% numOfEvents = Event.where(:eventDate => dayHolder).count %>
                        <% if numOfEvents != 0 %>
                            Events: <%= Event.where(:eventDate => dayHolder).count %>
                            <%= link_to'<i class="fas fa-eye"></i>'.html_safe, calendar_view_path(:calendar_view_id, day: dayHolder), :title => "View Events" %>
                        <% end %>
                    </div>
                </td>
                <% dayNum += 1 %>
            <% end %>
        <% end %>
    </tr>
    <% for week in 2..6 %>
        <tr>
            <% for day in 1..7 %>
                <% if dayNum <= numOfDaysInMonth %>
                    <% dayHolder = Date.parse(dayNum.to_s+'-'+activeMonth.to_s+'-'+activeYear.to_s) %>
                    <td>
                        <%= dayNum %>
                        <div class="dayInfo">
                            <% numOfEvents = Event.where(:eventDate => dayHolder).count %>
                            <% if numOfEvents != 0 %>
                                Events: <%= Event.where(:eventDate => dayHolder).count %>
                                <%= link_to'<i class="fas fa-eye"></i>'.html_safe, calendar_view_path(:calendar_view_id, day: dayHolder), :title => "View Events" %>
                            <% end %>
                        </div>
                    </td>
                    <% dayNum += 1 %>
                <% else %>
                    <td class="inactive"></td>
                <% end %>
            <% end %>
        </tr>
    <% end %>
</table>